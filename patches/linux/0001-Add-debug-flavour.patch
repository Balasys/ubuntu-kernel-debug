From 0ac7b45ec42ea83beea2eeb22d853de9c309e511 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jakab=20Krist=C3=B3f?= <jakab.kristof@balasys.hu>
Date: Fri, 29 Jul 2016 14:44:05 +0000
Subject: [PATCH 1/6] Add debug flavour

Differences between generic and debug:
* CONFIG_KASAN=y
* CONFIG_KASAN_INLINE=y
---
 debian.xenial/config/amd64/config.flavour.debug      | 10 ++++++++++
 debian.xenial/config/amd64/config.flavour.generic    |  1 +
 debian.xenial/config/amd64/config.flavour.lowlatency |  1 +
 debian.xenial/config/arm64/config.common.arm64       |  1 +
 debian.xenial/config/armhf/config.common.armhf       |  1 +
 debian.xenial/config/config.common.ubuntu            |  6 +++++-
 debian.xenial/config/i386/config.common.i386         |  1 +
 debian.xenial/config/powerpc/config.common.powerpc   |  1 +
 debian.xenial/config/ppc64el/config.common.ppc64el   |  1 +
 debian.xenial/config/s390x/config.common.s390x       |  1 +
 debian.xenial/control.d/vars.debug                   |  6 ++++++
 11 files changed, 29 insertions(+), 1 deletion(-)
 create mode 100644 debian.xenial/config/amd64/config.flavour.debug
 create mode 100644 debian.xenial/control.d/vars.debug

diff --git a/debian.xenial/config/amd64/config.flavour.debug b/debian.xenial/config/amd64/config.flavour.debug
new file mode 100644
index 0000000..06a660d
--- /dev/null
+++ b/debian.xenial/config/amd64/config.flavour.debug
@@ -0,0 +1,10 @@
+#
+# Config options for config.flavour.debug automatically generated by splitconfig.pl
+#
+CONFIG_HZ=250
+# CONFIG_HZ_1000 is not set
+CONFIG_HZ_250=y
+# CONFIG_IRQ_FORCED_THREADING_DEFAULT is not set
+CONFIG_KASAN=y
+# CONFIG_PREEMPT is not set
+CONFIG_PREEMPT_VOLUNTARY=y
diff --git a/debian.xenial/config/amd64/config.flavour.generic b/debian.xenial/config/amd64/config.flavour.generic
index 5c2e4e1..aa840d5 100644
--- a/debian.xenial/config/amd64/config.flavour.generic
+++ b/debian.xenial/config/amd64/config.flavour.generic
@@ -5,5 +5,6 @@ CONFIG_HZ=250
 # CONFIG_HZ_1000 is not set
 CONFIG_HZ_250=y
 # CONFIG_IRQ_FORCED_THREADING_DEFAULT is not set
+# CONFIG_KASAN is not set
 # CONFIG_PREEMPT is not set
 CONFIG_PREEMPT_VOLUNTARY=y
diff --git a/debian.xenial/config/amd64/config.flavour.lowlatency b/debian.xenial/config/amd64/config.flavour.lowlatency
index 6b121e3..ab3f1a8 100644
--- a/debian.xenial/config/amd64/config.flavour.lowlatency
+++ b/debian.xenial/config/amd64/config.flavour.lowlatency
@@ -5,5 +5,6 @@ CONFIG_HZ=1000
 CONFIG_HZ_1000=y
 # CONFIG_HZ_250 is not set
 CONFIG_IRQ_FORCED_THREADING_DEFAULT=y
+# CONFIG_KASAN is not set
 CONFIG_PREEMPT=y
 # CONFIG_PREEMPT_VOLUNTARY is not set
diff --git a/debian.xenial/config/arm64/config.common.arm64 b/debian.xenial/config/arm64/config.common.arm64
index b7991ea..54a99ac 100644
--- a/debian.xenial/config/arm64/config.common.arm64
+++ b/debian.xenial/config/arm64/config.common.arm64
@@ -164,6 +164,7 @@ CONFIG_JFS_FS=m
 CONFIG_JME=m
 CONFIG_JUMP_LABEL=y
 CONFIG_KARMA_PARTITION=y
+# CONFIG_KASAN is not set
 CONFIG_KVM=y
 CONFIG_LAPB=m
 CONFIG_LDM_PARTITION=y
diff --git a/debian.xenial/config/armhf/config.common.armhf b/debian.xenial/config/armhf/config.common.armhf
index f3d209b..844cbe0 100644
--- a/debian.xenial/config/armhf/config.common.armhf
+++ b/debian.xenial/config/armhf/config.common.armhf
@@ -154,6 +154,7 @@ CONFIG_JFS_FS=m
 CONFIG_JME=m
 # CONFIG_JUMP_LABEL is not set
 CONFIG_KARMA_PARTITION=y
+# CONFIG_KASAN is not set
 CONFIG_KERNEL_GZIP=y
 # CONFIG_KERNEL_XZ is not set
 CONFIG_KVM=y
diff --git a/debian.xenial/config/config.common.ubuntu b/debian.xenial/config/config.common.ubuntu
index 1bd02e9..c5b6055 100644
--- a/debian.xenial/config/config.common.ubuntu
+++ b/debian.xenial/config/config.common.ubuntu
@@ -1421,6 +1421,7 @@ CONFIG_COMPAT_OLD_SIGACTION=y
 CONFIG_CONNECTOR=y
 CONFIG_CONSOLE_POLL=y
 CONFIG_CONSOLE_TRANSLATIONS=y
+CONFIG_CONSTRUCTORS=y
 CONFIG_CONTEXT_SWITCH_TRACER=y
 CONFIG_COPS=m
 CONFIG_COPS_DAYNA=y
@@ -3964,7 +3965,9 @@ CONFIG_JSA1212=m
 CONFIG_K3_DMA=m
 CONFIG_KALLSYMS=y
 CONFIG_KALLSYMS_ALL=y
-# CONFIG_KASAN is not set
+CONFIG_KASAN_INLINE=y
+# CONFIG_KASAN_OUTLINE is not set
+CONFIG_KASAN_SHADOW_OFFSET=0xdffffc0000000000
 CONFIG_KDB_CONTINUE_CATASTROPHIC=0
 CONFIG_KDB_DEFAULT_ENABLE=0x1
 CONFIG_KDB_KEYBOARD=y
@@ -7798,6 +7801,7 @@ CONFIG_TERANETICS_PHY=m
 CONFIG_TEST_BPF=m
 CONFIG_TEST_FIRMWARE=m
 CONFIG_TEST_HEXDUMP=m
+# CONFIG_TEST_KASAN is not set
 CONFIG_TEST_KSTRTOX=m
 # CONFIG_TEST_LIST_SORT is not set
 CONFIG_TEST_LKM=m
diff --git a/debian.xenial/config/i386/config.common.i386 b/debian.xenial/config/i386/config.common.i386
index a76ea7c..166faa6 100644
--- a/debian.xenial/config/i386/config.common.i386
+++ b/debian.xenial/config/i386/config.common.i386
@@ -156,6 +156,7 @@ CONFIG_JFS_FS=m
 CONFIG_JME=m
 CONFIG_JUMP_LABEL=y
 CONFIG_KARMA_PARTITION=y
+# CONFIG_KASAN is not set
 CONFIG_KERNEL_GZIP=y
 # CONFIG_KERNEL_XZ is not set
 CONFIG_KVM=m
diff --git a/debian.xenial/config/powerpc/config.common.powerpc b/debian.xenial/config/powerpc/config.common.powerpc
index a6a8e41..0cfeeb5 100644
--- a/debian.xenial/config/powerpc/config.common.powerpc
+++ b/debian.xenial/config/powerpc/config.common.powerpc
@@ -150,6 +150,7 @@ CONFIG_JFS_FS=m
 CONFIG_JME=m
 CONFIG_JUMP_LABEL=y
 CONFIG_KARMA_PARTITION=y
+# CONFIG_KASAN is not set
 CONFIG_KVM=y
 CONFIG_LAPB=m
 CONFIG_LDM_PARTITION=y
diff --git a/debian.xenial/config/ppc64el/config.common.ppc64el b/debian.xenial/config/ppc64el/config.common.ppc64el
index 6c29ca6..fca6193 100644
--- a/debian.xenial/config/ppc64el/config.common.ppc64el
+++ b/debian.xenial/config/ppc64el/config.common.ppc64el
@@ -170,6 +170,7 @@ CONFIG_JFS_FS=m
 CONFIG_JME=m
 CONFIG_JUMP_LABEL=y
 CONFIG_KARMA_PARTITION=y
+# CONFIG_KASAN is not set
 CONFIG_KERNEL_START=0xc000000000000000
 CONFIG_KVM=y
 CONFIG_LAPB=m
diff --git a/debian.xenial/config/s390x/config.common.s390x b/debian.xenial/config/s390x/config.common.s390x
index 15423a5..fc39a99 100644
--- a/debian.xenial/config/s390x/config.common.s390x
+++ b/debian.xenial/config/s390x/config.common.s390x
@@ -131,6 +131,7 @@ CONFIG_IP_DCCP_CCID3=y
 # CONFIG_JME is not set
 CONFIG_JUMP_LABEL=y
 # CONFIG_KARMA_PARTITION is not set
+# CONFIG_KASAN is not set
 # CONFIG_KERNEL_GZIP is not set
 CONFIG_KERNEL_XZ=y
 CONFIG_KVM=y
diff --git a/debian.xenial/control.d/vars.debug b/debian.xenial/control.d/vars.debug
new file mode 100644
index 0000000..37db0e9
--- /dev/null
+++ b/debian.xenial/control.d/vars.debug
@@ -0,0 +1,6 @@
+arch="amd64"
+supported="Debug"
+target="Geared toward desktop and server systems."
+desc="=HUMAN= SMP"
+bootloader="grub-pc [i386 amd64 x32] | grub-efi-amd64 [amd64 x32] | grub-efi-ia32 [i386 amd64 x32] | grub [i386 amd64 x32] | lilo [i386 amd64 x32] | flash-kernel [armhf arm64]"
+provides="kvm-api-4, redhat-cluster-modules, ivtv-modules, virtualbox-guest-modules [i386 amd64 x32]"
-- 
2.9.2

